<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã¦ã¥ãã‚ŠMNIST - ãƒ¡ãƒ‹ãƒ¥ãƒ¼</title>

  <!-- Primary Meta Tags -->
  <meta name="title" content="ã¦ã¥ãã‚ŠMNIST - ã˜ã¶ã‚“ã®ã‚‚ã˜ã§ ã•ã‚“ã™ã†ã‚’ã¾ãªã¼ã†ï¼">
  <meta name="description" content="ã“ã©ã‚‚å‘ã‘ã®ãã‹ã„ãŒãã—ã‚…ã†ã‚¢ãƒ—ãƒªã€‚ã˜ã¶ã‚“ã§ã‹ã„ãŸã™ã†ã˜ã‚’ã¤ã‹ã£ã¦ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ãŒãã—ã‚…ã†ã•ã›ã€ã•ã‚“ã™ã†ã‚²ãƒ¼ãƒ ã§ã‚ãã¹ã¾ã™ã€‚">
  <meta name="keywords" content="æ©Ÿæ¢°å­¦ç¿’,æ•™è‚²,å­ã©ã‚‚,ç®—æ•°,MNIST,PyTorch,FastAPI">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœ‹</text></svg>">

  <!-- Theme Color -->
  <meta name="theme-color" content="#fef3c7">

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Alpine.js -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
  <div id="globalLoadingOverlay" class="fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50" style="display: none;">
    <div class="text-center">
      <div class="loading-spinner mb-4"></div>
      <p id="loadingMessage" class="text-xl font-bold">ã‚ˆã¿ã“ã¿ã¡ã‚…ã†...</p>
    </div>
  </div>

  <!-- ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° -->
  <script>
  window.addEventListener('error', (e) => {
    if (e.message.includes('cdn') || e.message.includes('unpkg')) {
      showErrorMessage('ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã›ã¤ãããŒã²ã¤ã‚ˆã†ã§ã™ã€‚\nWi-Fiã‚„ãƒ¢ãƒã‚¤ãƒ«ã¤ã†ã—ã‚“ã‚’ã‹ãã«ã‚“ã—ã¦ãã ã•ã„ã€‚');
    }
  }, true);

  function showErrorMessage(message) {
    const errorDiv = document.createElement('div');
    errorDiv.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    errorDiv.innerHTML = `
      <div class="bg-white rounded-lg p-6 max-w-md mx-4 text-center">
        <div class="text-4xl mb-4">âš ï¸</div>
        <p class="text-lg font-bold mb-4 whitespace-pre-line">${message}</p>
        <button onclick="location.reload()" class="btn-primary">
          ã‚‚ã†ã„ã¡ã© ã‚ˆã¿ã“ã‚€
        </button>
      </div>
    `;
    document.body.appendChild(errorDiv);
  }

  function showLoading(message = 'ã‚ˆã¿ã“ã¿ã¡ã‚…ã†...') {
    const overlay = document.getElementById('globalLoadingOverlay');
    const messageEl = document.getElementById('loadingMessage');
    if (overlay && messageEl) {
      messageEl.textContent = message;
      overlay.style.display = 'flex';
    }
  }

  function hideLoading() {
    const overlay = document.getElementById('globalLoadingOverlay');
    if (overlay) {
      overlay.style.display = 'none';
    }
  }
  </script>

  <div class="container mx-auto px-4 py-8" x-data="menuApp()">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="header text-center">
      <h1 class="text-4xl font-bold mb-2">âœ‹ ã¦ã¥ãã‚ŠMNIST</h1>
      <p class="text-lg">ã˜ã¶ã‚“ã®ã‚‚ã˜ã§ ã•ã‚“ã™ã†ã‚’ã¾ãªã¼ã†ï¼</p>
    </div>

    <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ -->
    <div class="space-y-4 mb-8">
      <!-- ã‚‚ã˜ã‚’ã‹ã -->
      <a href="collect.html" class="block">
        <button class="btn-primary w-full">
          ğŸ“ ã‚‚ã˜ã‚’ã‹ã
        </button>
      </a>

      <!-- ãŒãã—ã‚…ã† -->
      <a href="train.html" class="block">
        <button class="btn-primary w-full">
          ğŸ§  ãŒãã—ã‚…ã†
        </button>
      </a>

      <!-- ã‚²ãƒ¼ãƒ ã§ã‚ãã¶ -->
      <a href="game.html" class="block">
        <button class="btn-primary w-full">
          ğŸ® ã‚²ãƒ¼ãƒ ã§ã‚ãã¶
        </button>
      </a>
    </div>

    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
    <div class="card">
      <h2 class="text-xl font-bold mb-4">ã’ã‚“ã–ã„ã®ã˜ã‚‡ã†ãã‚‡ã†</h2>

      <div class="space-y-3">
        <!-- ãƒ‡ãƒ¼ã‚¿åé›†çŠ¶æ³ -->
        <div class="flex items-center justify-between">
          <span class="font-semibold">ã—ã‚…ã†ã—ã‚…ã†ãšã¿:</span>
          <span class="text-lg" x-text="`${status.total}/100 ã‚µãƒ³ãƒ—ãƒ«`"></span>
        </div>

        <!-- ãƒ¢ãƒ‡ãƒ«å­¦ç¿’çŠ¶æ³ -->
        <div class="flex items-center justify-between">
          <span class="font-semibold">ãƒ¢ãƒ‡ãƒ«:</span>
          <span x-text="status.modelStatus" class="status-badge"
                :class="status.modelTrained ? 'status-success' : 'status-warning'">
          </span>
        </div>
      </div>
    </div>

    <!-- èª¬æ˜ -->
    <div class="card mt-4">
      <h3 class="text-lg font-bold mb-2">ã‚ãã³ã‹ãŸ</h3>
      <ol class="list-decimal list-inside space-y-2 text-sm">
        <li>ã€Œã‚‚ã˜ã‚’ã‹ãã€ã§ 0-9 ã®ã™ã†ã˜ã‚’ã‹ã</li>
        <li>ã€ŒãŒãã—ã‚…ã†ã€ã§ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ãŠã¼ãˆã¦ã‚‚ã‚‰ã†</li>
        <li>ã€Œã‚²ãƒ¼ãƒ ã§ã‚ãã¶ã€ã§ã•ã‚“ã™ã†ã‚‚ã‚“ã ã„ã«ã¡ã‚‡ã†ã›ã‚“ï¼</li>
      </ol>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/api.js"></script>
  <script>
    function menuApp() {
      return {
        status: {
          total: 0,
          modelStatus: 'ã¿ãŒãã—ã‚…ã†',
          modelTrained: false
        },

        async init() {
          try {
            console.log('Updating status...');
            await this.updateStatus();
            console.log('Status update complete');
          } catch (error) {
            console.error('Initialization error:', error);
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ã§ã¯è­¦å‘Šã‚’å‡ºã•ãšã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¡¨ç¤º
            console.warn('Using default status values');
          }
        },

        async updateStatus() {
          try {
            // ãƒ‡ãƒ¼ã‚¿åé›†çŠ¶æ³ã‚’å–å¾—
            const dataStatus = await checkDataRequirements();
            this.status.total = dataStatus.total;

            // ãƒ¢ãƒ‡ãƒ«å­¦ç¿’çŠ¶æ³ã‚’ç¢ºèª
            const modelsStatus = await getModelsStatus();

            if (modelsStatus.cnn.trained) {
              this.status.modelStatus = 'ãŒãã—ã‚…ã†ãšã¿ âœ“';
              this.status.modelTrained = true;
            } else {
              this.status.modelStatus = 'ã¿ãŒãã—ã‚…ã†';
              this.status.modelTrained = false;
            }
          } catch (error) {
            console.error('Failed to update status:', error);
            // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ç¶­æŒ
            this.status.total = 0;
            this.status.modelStatus = 'ã¿ãŒãã—ã‚…ã†';
            this.status.modelTrained = false;
          }
        }
      }
    }
  </script>
</body>
</html>
